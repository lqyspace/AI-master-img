[toc]

# 雪花算法

是由Twitter公布的分布式主键生成算法，它能够保证不同表的主键的不重复性，以及相同表的表的主键的有序性。

> **核心思想**

长度共64位（一个long型）。

首先是一个符合位，1bit标识，由于long基本类型在java中是带有符号的，最高位是符号位，正数是0，负数是1，所以id一般是正数，最高位是0.

41bit时间戳（毫秒级），存储的是时间戳的差值（当前时间戳-开始时间戳），结果约等于69.73年。

10bit作为机器的ID（5个bit是数据中心，5bit的机器id，可以部署在1024个节点）。

12bit作为毫秒内的流水号（意味着每个节点在每毫秒可以产生4096个ID）。

![image-20240830141840564](https://cdn.jsdelivr.net/gh/lqyspace/AI-master-img@master/img/202408301418603.png)

> **优点**

整体上按照时间自增排序，并且整个分布式系统内不会产生ID碰撞，并且效率较高。